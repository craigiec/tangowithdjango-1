{% extends 'base.html' %}
{% load static %}



{% block body_block %}

    <div class="row main-content">

        <div class="breadcrumbs-wrapper">
            <li><a href="#">Home</a></li>
            <li><a href="{% url 'laws' %}">Laws</a></li>
            <li>{{ law.name }}</li>
        </div><!-- .breadcrumbs-wrapper -->

        <div class="index-search-wrapper search">
            <input type="text" name="search" placeholder="Search for Laws, MSPs, ..." />
            <input type="submit" name="submit-search" value="" />
        </div><!-- .search -->

        <div class="content-inner">

            <div class="content-inner-header">
                <h2>{{ law.name }}</h2>
                <div class="tag">{{ law.topic }}</div>
                <div class="tag upcoming">{{ upcoming }}</div>

                <div class="right-side" data-lawid="{{ law.id }}">
                    {% if user.is_authenticated %}
                        {% if user_vote.voted %}
                            <div class="against number">{{ votes_against }}</div>
                            <div class="approve number">{{ votes_for }}</div>
                        {% else %}
                            <div class="user_vote against">{{ votes_against }}</div>
                            <div class="user_vote approve">{{ votes_for }}</div>
                        {% endif %}
                    {% else %}
                        <div class="against number">{{ votes_against }}</div>
                        <div class="approve number">{{ votes_for }}</div>
                    {% endif %}
                </div><!-- .right -->
            </div><!-- .content-inner-header -->

            <div class="content-inner-content">

                <div class="row">
                    <div class="large-6 medium-6 small-12 columns">
                        <p>{{ law.text }}</p>
                    </div><!-- column holding a description of a law -->

                    <div class="large-5 medium-5 small-12 columns">
                        <div class="row vote-table">
                            <div class="large-4 medium-4 small-12 columns">
                                <div class="col">
                                    {% if user.is_authenticated %}
                                        <h4>Your vote</h4>
                                        <div class="your-vote{% if user_vote.voted %}{% if user_vote.vote_for %} yes{% else %} no{% endif %}{% endif %}"></div>
                                    {% else %}
                                        <h4>Log in to vote</h4>
                                        <div class="your-vote"></div>
                                    {% endif %}
                                </div><!-- col -->
                            </div>
                            <div class="large-4 medium-4 small-12 columns">
                                <div class="col">
                                    <h4>Date</h4>
                                    <div>{{ law.date }}</div>
                                </div><!-- col -->
                            </div>
                            <div class="large-4 medium-4 small-12 columns">
                                <div class="col">
                                    <h4>Result</h4>

                                    <div>
                                        {% if law.result == '1' %}
                                            Carried
                                        {% else %}
                                            Defeated
                                        {% endif %}
                                    </div>
                                </div><!-- col -->
                            </div>
                        </div><!-- row holding a table -->
                    </div><!-- column holding a table -->
                </div><!-- row holding a description and a table -->

                <div class="row my-msp-vote">
                    <div class="large-12 medium-12 small-12 columns">
                        {% if user_msps %}
                            {% for msp, msp_vote in user_msps %}

                                <div class="large-3 medium-3 small-6 columns">
                                    <div class="msp-wrap">
                                        <div class="vote {% if msp_vote.vote == '1' %}yes{% elif msp_vote.vote == '2' %}no{% endif %}"></div>
                                        <h6>{{ msp.firstname }} {{ msp.lastname }}</h6>
                                        <img src="{% static "img/msps/" %}{{ msp.firstname }}{{ msp.lastname }}.jpg" />
                                    </div>
                                </div><!-- one particular msp -->

                            {% endfor %}
                        {% endif %}
                    </div>
                </div><!-- row holding my msps votes -->

            </div><!-- .content-inner-content -->
        </div><!-- .content-inner -->

    </div><!-- row containing main content with white transparent background -->

    <div class="row">
        <div class="large-12 small-12 columns comments">
            <div class="comments-header">
                <div class="left">
                    Comments &nbsp;<span id="comments_number">{{ comments_number }}</span>
                </div>
                <div class="right">
                    {% if user.is_authenticated %}
                    Commeting as {{ user.username }}
                    {% else %}
                    <a href="#login">Log in</a> to comment
                    {% endif %}
                </div>
            </div>
            {% if user.is_authenticated %}
            <div class="textarea">
                <form id="comment_form" method="post" action="/representME/add_comment/">
                    {% csrf_token %}
                    {{ commentForm.text }}
                    <!--<textarea name="comment-text" placeholder="Add your message here..."></textarea>-->
                    <input type="submit" name="send-comment" value="" />
                </form>
            </div><!-- .textarea -->
            {% endif %}
            <div class="latest-laws-wrapper-inner" id="comments-wrapper">
                {% if comments %}
                    {% for comment in comments %}

                        <div class="latest-law">
                            <h3>{{ comment.user }} &nbsp;&nbsp;<span>{{ comment.time|date:"d/m/Y - H.i" }}</span></h3>
                            <p>{{ comment.text }}</p>
                        </div><!-- .latest-law -->

                    {% endfor %}
                {% else %}
                    <div class="latest-law no-comments">
                        <p>No comments added yet, be the first to comment!</p>
                    </div><!-- .latest-law -->
                {% endif %}
            </div><!-- .latest-laws-wrapper-inner -->
        </div>
    </div><!-- row containing discussion -->

{% endblock %}